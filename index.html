<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>@motioneffector/llm - Demo</title>
  <link rel="stylesheet" href="demo-files/demo.css">
</head>
<body>
  <div class="page">
    <header class="header">
      <h1 class="header-title">@motioneffector/llm</h1>
      <p class="header-description">TypeScript client for LLM APIs with streaming, conversations, and automatic retries</p>
      <nav class="header-links">
        <a href="https://www.npmjs.com/package/@motioneffector/llm" class="header-link" target="_blank">
          üì¶ npm
        </a>
        <a href="https://github.com/motioneffector/llm" class="header-link" target="_blank">
          üíª GitHub
        </a>
        <a href="https://github.com/motioneffector/llm/wiki" class="header-link" target="_blank">
          üìñ Manual
        </a>
        <span class="simulated-badge">üî∂ SIMULATED</span>
      </nav>
    </header>

    <main>
      <!-- Test Runner (FIRST) -->
      <section class="test-runner" id="test-runner">
        <div class="test-runner-header">
          <h2 class="test-runner-title">Test Runner</h2>
        </div>
        <div class="test-runner-content">
          <!-- Control bar: progress bar + buttons, above output console -->
          <div class="test-control-bar">
            <div class="test-progress">
              <div class="test-progress-bar">
                <div class="test-progress-fill" id="progress-fill"></div>
              </div>
              <div class="test-progress-text" id="progress-text">Ready</div>
            </div>
            <div class="test-runner-actions">
              <button class="btn btn-primary" id="run-all-tests">
                <span class="btn-icon">‚ñ∂</span>
                <span>Run All Tests</span>
              </button>
              <button class="btn btn-secondary" id="reset-page">
                <span class="btn-icon">‚Üª</span>
                <span>Reset Page</span>
              </button>
            </div>
          </div>
          <!-- Output console below the control bar -->
          <div class="test-output" id="test-output">
            <div class="test-output-placeholder">Click "Run All Tests" to execute the test suite and see a live demonstration</div>
          </div>
          <div class="test-summary hidden" id="test-summary"></div>
        </div>
      </section>

      <!-- Exhibit 1: Stream Decoder -->
      <section class="exhibit" id="exhibit-stream-decoder">
        <div class="exhibit-header">
          <h2 class="exhibit-title">Stream Decoder</h2>
          <p class="exhibit-description">Watch how streaming actually works - SSE events arrive, get parsed, and assemble into readable text</p>
        </div>
        <div class="exhibit-content">
          <div class="exhibit-interactive">
            <div class="stream-panels">
              <div class="stream-panel">
                <div class="stream-panel-title">Raw SSE Stream</div>
                <div class="stream-panel-content" id="sse-raw"></div>
              </div>
              <div class="stream-panel">
                <div class="stream-panel-title">Parsed Chunks</div>
                <div class="stream-panel-content" id="sse-chunks"></div>
              </div>
              <div class="stream-panel">
                <div class="stream-panel-title">Assembled Output</div>
                <div class="stream-panel-content">
                  <div class="output-text" id="sse-output"></div>
                </div>
              </div>
            </div>
          </div>
          <div class="exhibit-controls">
            <select class="input" id="stream-preset">
              <option value="short">Short response</option>
              <option value="code">Code example</option>
              <option value="long">Long response</option>
              <option value="emoji">Emoji content</option>
            </select>
            <button class="btn btn-primary" id="stream-run">‚ñ∂ Run</button>
            <button class="btn btn-secondary" id="stream-pause">‚è∏ Pause</button>
            <button class="btn btn-secondary" id="stream-replay">‚Üª Replay</button>
            <div class="slider-container">
              <span class="text-secondary">Speed:</span>
              <input type="range" id="stream-speed" min="10" max="500" value="100">
              <span class="slider-value" id="stream-speed-value">100ms</span>
            </div>
          </div>
          <div class="exhibit-state">
            <div class="exhibit-state-title">State</div>
            <div class="flex gap-lg">
              <div><span class="text-muted">Chunks:</span> <span id="stream-chunk-count">0</span></div>
              <div><span class="text-muted">Bytes:</span> <span id="stream-bytes">0</span></div>
              <div><span class="text-muted">Status:</span> <span id="stream-status" class="tag">Ready</span></div>
              <div><span class="text-muted">Time:</span> <span id="stream-time">0.00s</span></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Exhibit 2: Resilience Lab -->
      <section class="exhibit" id="exhibit-resilience-lab">
        <div class="exhibit-header">
          <h2 class="exhibit-title">Resilience Lab</h2>
          <p class="exhibit-description">See retry logic in action - exponential backoff, jitter, and error handling made visible</p>
        </div>
        <div class="exhibit-content">
          <div class="exhibit-interactive">
            <div class="timeline-container">
              <div class="timeline" id="resilience-timeline"></div>
              <div class="event-log" id="resilience-log"></div>
            </div>
          </div>
          <div class="exhibit-controls">
            <div class="scenario-buttons">
              <button class="scenario-btn active" data-scenario="success">Clean Success</button>
              <button class="scenario-btn" data-scenario="rate-limit">Rate Limit (429)</button>
              <button class="scenario-btn" data-scenario="server-error">Server Error (503)</button>
              <button class="scenario-btn" data-scenario="timeout">Network Timeout</button>
              <button class="scenario-btn" data-scenario="auth">Auth Failure (401)</button>
              <button class="scenario-btn" data-scenario="max-retries">Max Retries</button>
            </div>
            <button class="btn btn-danger" id="resilience-abort" disabled>Abort</button>
            <label class="toggle">
              <input type="checkbox" id="resilience-accelerated" checked>
              <span class="toggle-switch"></span>
              <span class="toggle-label">10x Speed</span>
            </label>
          </div>
          <div class="exhibit-state">
            <div class="exhibit-state-title">State</div>
            <div class="flex gap-lg">
              <div><span class="text-muted">Attempt:</span> <span id="resilience-attempt">-</span></div>
              <div><span class="text-muted">Next retry:</span> <span id="resilience-countdown">-</span></div>
              <div><span class="text-muted">Elapsed:</span> <span id="resilience-elapsed">0.00s</span></div>
              <div><span class="text-muted">Retriable:</span> <span id="resilience-retriable">-</span></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Exhibit 3: Conversation State Machine -->
      <section class="exhibit" id="exhibit-conversation">
        <div class="exhibit-header">
          <h2 class="exhibit-title">Conversation State Machine</h2>
          <p class="exhibit-description">See the actual data structures being built - watch the messages array grow in real-time</p>
        </div>
        <div class="exhibit-content">
          <div class="exhibit-interactive">
            <div class="conversation-split">
              <div class="conversation-panel">
                <div class="conversation-panel-title">Conversation</div>
                <div class="messages-container" id="conv-messages"></div>
                <div class="message-input-area">
                  <input type="text" class="input" id="conv-input" placeholder="Type a message...">
                  <button class="btn btn-primary" id="conv-send">Send</button>
                </div>
              </div>
              <div class="conversation-panel">
                <div class="conversation-panel-title">State Inspector</div>
                <div class="json-inspector" id="conv-json">
                  <pre></pre>
                </div>
                <div class="context-bar-container">
                  <div class="flex justify-between">
                    <span class="text-muted text-xs">Token usage</span>
                    <span class="text-muted text-xs" id="conv-token-count">0 / 200,000</span>
                  </div>
                  <div class="context-bar">
                    <div class="context-bar-fill" id="conv-context-fill" style="width: 0%"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="exhibit-controls">
            <select class="input" id="conv-preset">
              <option value="coding">Coding Q&A</option>
              <option value="creative">Creative Writing</option>
              <option value="long">Long Context</option>
              <option value="empty">Empty Slate</option>
            </select>
            <button class="btn btn-secondary" id="conv-load-preset">Load Preset</button>
            <button class="btn btn-secondary" id="conv-clear">Clear</button>
            <button class="btn btn-danger" id="conv-clear-all">Clear All</button>
          </div>
        </div>
      </section>

      <!-- Exhibit 4: Token Visualizer -->
      <section class="exhibit" id="exhibit-token-visualizer">
        <div class="exhibit-header">
          <h2 class="exhibit-title">Token Visualizer</h2>
          <p class="exhibit-description">See how token estimation works - watch text get chunked into ~4-character blocks</p>
        </div>
        <div class="exhibit-content">
          <div class="exhibit-interactive">
            <div class="token-input-area">
              <textarea class="input" id="token-input" placeholder="Type or paste text...">The quick brown fox jumps over the lazy dog. This classic pangram contains every letter of the English alphabet at least once, making it perfect for testing fonts and keyboards.</textarea>
            </div>
            <div class="token-blocks" id="token-blocks"></div>
            <div class="token-stats">
              <div class="token-stat">
                <div class="token-stat-label">Characters</div>
                <div class="token-stat-value" id="token-chars">0</div>
              </div>
              <div class="token-stat">
                <div class="token-stat-label">Estimated Tokens</div>
                <div class="token-stat-value" id="token-count">0</div>
              </div>
              <div class="token-stat">
                <div class="token-stat-label">Est. Prompt Cost</div>
                <div class="token-stat-value" id="token-cost">$0.00</div>
              </div>
            </div>
            <table class="model-table" id="model-table">
              <thead>
                <tr>
                  <th>Model</th>
                  <th>Context</th>
                  <th>$/M Prompt</th>
                  <th>$/M Completion</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div class="exhibit-controls">
            <select class="input" id="token-preset">
              <option value="pangram">Pangram</option>
              <option value="code">Code Snippet</option>
              <option value="long">Long Text</option>
              <option value="minimal">Minimal</option>
              <option value="unicode">Unicode</option>
            </select>
            <button class="btn btn-secondary" id="token-load-preset">Load Preset</button>
            <button class="btn btn-secondary" id="token-reset">Reset</button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Library (simulated for demo) -->
  <script type="module">
    // Simulated library for demo purposes
    window.Library = {
      // This is a simulated placeholder
      // In production, this would be: import * as Library from './dist/index.js'
    }
  </script>

  <!-- Demo scripts (order matters) -->
  <script src="demo-files/test-runner.js"></script>
  <script src="demo-files/demo.js"></script>
  <script src="demo-files/tests.js"></script>
</body>
</html>
